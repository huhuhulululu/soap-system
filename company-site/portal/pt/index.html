<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PT Portal · RBMS | Sign In 登录</title>
  <meta name="description" content="RBMS Physical Therapy Portal — Sign in to access claims management, payment tracking, and practice analytics.">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%232b3c36'/%3E%3Cpath d='M10 16l4 4 8-8' stroke='%23fbf9f5' stroke-width='2.5' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=IBM+Plex+Sans:wght@300;400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ink: { 50:'#f4f7f6',100:'#e3ebe8',200:'#c7d7d1',300:'#a3bdb3',400:'#7a9e91',500:'#5a8274',600:'#47695d',700:'#3b564d',800:'#324740',900:'#2b3c36',950:'#16211e' },
            paper: { 50:'#fefdfb',100:'#fbf9f5',200:'#f7f3eb',300:'#f0e9dc',400:'#e5d9c5' },
          },
          fontFamily: {
            display: ['Playfair Display','Georgia','serif'],
            sans: ['IBM Plex Sans','system-ui','sans-serif'],
            mono: ['IBM Plex Mono','monospace'],
          }
        }
      }
    }
  </script>
  <style>
    body { font-family: 'IBM Plex Sans', system-ui, sans-serif; }
    .reveal { opacity:0; transform:translateY(24px); transition: opacity .6s cubic-bezier(.16,1,.3,1), transform .6s cubic-bezier(.16,1,.3,1); }
    .reveal.v { opacity:1; transform:translateY(0); }
    .rd1{transition-delay:.1s}.rd2{transition-delay:.2s}.rd3{transition-delay:.3s}.rd4{transition-delay:.4s}
    .grain::after { content:''; position:fixed; inset:0; z-index:9999; pointer-events:none; opacity:.018; background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E"); }
    .login-btn { transition: transform .3s ease, box-shadow .3s ease; }
    .login-btn:hover:not(:disabled) { transform:translateY(-2px); box-shadow:0 8px 24px -4px rgba(22,33,30,.2); }
    .login-btn:disabled { opacity:.6; cursor:not-allowed; }
    .shake { animation: shake .4s ease-in-out; }
    @keyframes shake { 0%,100%{transform:translateX(0)} 20%,60%{transform:translateX(-6px)} 40%,80%{transform:translateX(6px)} }
    input:focus { outline:none; border-color:#5a8274; box-shadow:0 0 0 3px rgba(90,130,116,.15); }
  </style>
</head>
<body class="grain bg-paper-50 text-ink-800 antialiased min-h-screen flex flex-col">

  <!-- NAV -->
  <nav class="border-b border-ink-100/60 bg-paper-50/90 backdrop-blur-xl sticky top-0 z-50">
    <div class="max-w-4xl mx-auto px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <a href="/" class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-lg bg-ink-800 flex items-center justify-center">
            <svg class="w-4 h-4 text-paper-50" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
            </svg>
          </div>
          <div class="flex items-center gap-2">
            <span class="font-display text-base font-semibold text-ink-900">RBMS</span>
            <span class="text-ink-300">·</span>
            <span class="text-xs text-ink-400 font-mono">Physical Therapy Portal</span>
          </div>
        </a>
        <a href="/" class="text-xs text-ink-400 hover:text-ink-700 transition-colors flex items-center gap-1.5">
          <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>
          Back to Home 返回首页
        </a>
      </div>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="flex-1 flex items-center justify-center py-12 lg:py-20">
    <div class="max-w-md mx-auto px-6 w-full">

      <!-- Login Card -->
      <div class="reveal bg-white rounded-2xl border border-ink-100 p-8 lg:p-10">

        <!-- Header -->
        <div class="reveal rd1 text-center mb-8">
          <div class="w-14 h-14 rounded-2xl bg-ink-900 flex items-center justify-center mx-auto mb-5">
            <svg class="w-7 h-7 text-paper-100" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"/>
            </svg>
          </div>
          <h1 class="font-display text-2xl font-semibold text-ink-900 mb-1">Physical Therapy Portal</h1>
          <p class="text-sm text-ink-400">物理治疗门户 · Sign in to continue</p>
        </div>

        <!-- Login Form -->
        <form id="loginForm" class="reveal rd2 space-y-4">
          <!-- Error Message -->
          <div id="errorMsg" class="hidden px-4 py-3 rounded-lg bg-red-50 border border-red-200 text-sm text-red-600"></div>

          <!-- Username -->
          <div>
            <label for="username" class="block text-xs font-medium text-ink-500 mb-1.5">Username 用户名</label>
            <input type="text" id="username" name="username" required autocomplete="username" placeholder="Enter your username"
              class="w-full px-4 py-3 text-sm bg-paper-50 border border-ink-100 rounded-xl transition-all duration-200 placeholder:text-ink-300">
          </div>

          <!-- Password -->
          <div>
            <label for="password" class="block text-xs font-medium text-ink-500 mb-1.5">Password 密码</label>
            <div class="relative">
              <input type="password" id="password" name="password" required autocomplete="current-password" placeholder="Enter your password"
                class="w-full px-4 py-3 pr-10 text-sm bg-paper-50 border border-ink-100 rounded-xl transition-all duration-200 placeholder:text-ink-300">
              <button type="button" id="togglePw" class="absolute right-3 top-1/2 -translate-y-1/2 text-ink-300 hover:text-ink-500 transition-colors" aria-label="Toggle password visibility">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.64 0 8.577 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.64 0-8.577-3.007-9.963-7.178z"/><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
              </button>
            </div>
          </div>

          <!-- Submit -->
          <button type="submit" id="submitBtn"
            class="login-btn w-full px-6 py-3.5 text-sm font-semibold text-paper-50 bg-ink-800 rounded-xl hover:bg-ink-700 transition-colors mt-2">
            Sign In 登录
          </button>
        </form>

        <!-- Footer -->
        <div class="reveal rd3 mt-6 text-center">
          <p class="text-xs text-ink-300">Powered by Royal Billing Management Service</p>
        </div>
      </div>

      <!-- Help -->
      <div class="reveal rd4 text-center mt-6">
        <p class="text-xs text-ink-400">Need help? <a href="/#contact" class="text-ink-600 hover:underline">Contact RBMS Support</a> · 需要帮助？<a href="/#contact" class="text-ink-600 hover:underline">联系客服</a></p>
      </div>

    </div>
  </main>

  <!-- FOOTER -->
  <footer class="border-t border-ink-100 py-6">
    <div class="max-w-4xl mx-auto px-6 lg:px-8 flex items-center justify-between">
      <p class="text-xs text-ink-400">&copy; 2026 RBMS</p>
      <div class="flex items-center gap-4">
        <a href="/" class="text-xs text-ink-400 hover:text-ink-600 transition-colors">Home 首页</a>
        <a href="/portal/ac/" class="text-xs text-ink-400 hover:text-ink-600 transition-colors">AC Portal</a>
      </div>
    </div>
  </footer>

  <script>
    // Reveal animation
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('v'); });
    }, { threshold: 0.1 });
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

    // Toggle password visibility
    document.getElementById('togglePw').addEventListener('click', () => {
      const pw = document.getElementById('password');
      pw.type = pw.type === 'password' ? 'text' : 'password';
    });

    // Login form — directly authenticate with Tenfu system
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const btn = document.getElementById('submitBtn');
      const errEl = document.getElementById('errorMsg');
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;

      errEl.classList.add('hidden');
      btn.disabled = true;
      btn.textContent = 'Signing in... 登录中...';

      try {
        const res = await fetch('/pt/tf/api/auth/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          credentials: 'include',
          body: JSON.stringify({ username, password }),
        });
        const data = await res.json();

        if (data.success) {
          window.location.href = '/pt/tf/dashboard';
        } else {
          errEl.textContent = data.message || 'Login failed 登录失败';
          errEl.classList.remove('hidden');
          errEl.classList.add('shake');
          setTimeout(() => errEl.classList.remove('shake'), 500);
          btn.disabled = false;
          btn.textContent = 'Sign In 登录';
        }
      } catch (err) {
        errEl.textContent = 'Connection error. Please try again. 连接错误，请重试。';
        errEl.classList.remove('hidden');
        btn.disabled = false;
        btn.textContent = 'Sign In 登录';
      }
    });
  </script>
</body>
</html>
